# ç…§ç‰‡æ°´å°å·¥å…·

<div align="center">

[![English](https://img.shields.io/badge/lang-English-blue)](README.md)
[![ä¸­æ–‡](https://img.shields.io/badge/lang-ä¸­æ–‡-red)](README_CN.md)

</div>

## ğŸ“¸ é¡¹ç›®ç®€ä»‹

ä¸ºç…§ç‰‡æ·»åŠ æ°´å°çš„å·¥å…·ã€‚

## ğŸ›  å®‰è£…æ­¥éª¤

```bash
# å®‰è£…ä¾èµ–
uv sync
source .venv/bin/activate

# å®‰è£… git é’©å­è„šæœ¬
pre-commit install
```

## ğŸ“ å¼€å‘è¯´æ˜

### dev-00 éœ€æ±‚

å®Œæˆä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åº

ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‚

è¯»å–è¯¥è·¯å¾„ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ exif ä¿¡æ¯ä¸­çš„æ‹æ‘„æ—¶é—´ä¿¡æ¯ï¼Œé€‰å–å¹´æœˆæ—¥ï¼Œä½œä¸ºæ°´å°ã€‚

ç”¨æˆ·å¯ä»¥è®¾ç½®å­—ä½“å¤§å°ã€é¢œè‰²å’Œåœ¨å›¾ç‰‡ä¸Šçš„ä½ç½®ï¼ˆä¾‹å¦‚ï¼Œå·¦ä¸Šè§’ã€å±…ä¸­ã€å³ä¸‹è§’ï¼‰ã€‚

ç¨‹åºå°†æ–‡æœ¬æ°´å°ç»˜åˆ¶åˆ°å›¾ç‰‡ä¸Šï¼Œå¹¶ä¿å­˜ä¸ºæ–°çš„å›¾ç‰‡æ–‡ä»¶ï¼Œä¿å­˜åœ¨åŸç›®å½•å_watermarkçš„æ–°ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½•ä½œä¸ºåŸç›®å½•çš„å­ç›®å½•ã€‚

#### å‚æ•°è§£é‡Š

```text
å¿…é€‰å‚æ•°
IMAGE_DIRECTORY
éœ€è¦åŠ æ°´å°çš„å›¾ç‰‡æ‰€åœ¨ç›®å½•è·¯å¾„ã€‚

å¯é€‰å‚æ•°
--font-size, -s
æ°´å°å­—ä½“å¤§å°ï¼ˆé»˜è®¤ï¼š80ï¼‰

--color, -c
æ°´å°æ–‡å­—é¢œè‰²ï¼ˆé»˜è®¤ï¼šredï¼‰

--position, -p
æ°´å°åœ¨å›¾ç‰‡ä¸Šçš„ä½ç½®
å¯é€‰å€¼ï¼štop-left, top-center, top-right, center-left, center, center-right, bottom-left, bottom-center, bottom-right
é»˜è®¤ï¼šbottom-right

--use-file-date
å½“å›¾ç‰‡æ²¡æœ‰EXIFæ—¥æœŸæ—¶ï¼Œä½¿ç”¨æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä½œä¸ºæ°´å°æ—¥æœŸ

--default-date
å½“æ²¡æœ‰EXIFå’Œæ–‡ä»¶æ—¥æœŸæ—¶ï¼Œä½¿ç”¨æŒ‡å®šçš„é»˜è®¤æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
```

#### å‘½ä»¤è¡Œè¿è¡Œ

```bash
uv run watermark_cli.py test --font-size 100 --color gray --position center
```

### dev-01 éœ€æ±‚

æ°´å°æ–‡ä»¶æœ¬åœ°åº”ç”¨ï¼ˆWindows æˆ– MacOS)ï¼š

1. æ–‡ä»¶å¤„ç†
1.1å¯¼å…¥å›¾ç‰‡
æ”¯æŒå•å¼ å›¾ç‰‡æ‹–æ‹½æˆ–é€šè¿‡æ–‡ä»¶é€‰æ‹©å™¨å¯¼å…¥ã€‚
æ”¯æŒæ‰¹é‡å¯¼å…¥ï¼Œå¯ä¸€æ¬¡æ€§é€‰æ‹©å¤šå¼ å›¾ç‰‡æˆ–ç›´æ¥å¯¼å…¥æ•´ä¸ªæ–‡ä»¶å¤¹ã€‚
åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå·²å¯¼å…¥å›¾ç‰‡çš„åˆ—è¡¨ï¼ˆç¼©ç•¥å›¾å’Œæ–‡ä»¶åï¼‰ã€‚
1.2æ”¯æŒæ ¼å¼
è¾“å…¥æ ¼å¼ï¼šå¿…é¡»æ”¯æŒä¸»æµæ ¼å¼ï¼Œå¦‚ JPEG, PNGã€‚å¼ºçƒˆå»ºè®®æ”¯æŒ BMP, TIFFã€‚PNGæ ¼å¼å¿…é¡»æ”¯æŒé€æ˜é€šé“ã€‚
è¾“å‡ºæ ¼å¼ï¼šç”¨æˆ·å¯é€‰æ‹©è¾“å‡ºä¸º JPEG æˆ– PNGã€‚
1.3å¯¼å‡ºå›¾ç‰‡
ç”¨æˆ·å¯æŒ‡å®šä¸€ä¸ªè¾“å‡ºæ–‡ä»¶å¤¹ã€‚ä¸ºé˜²æ­¢è¦†ç›–åŸå›¾ï¼Œé»˜è®¤ç¦æ­¢å¯¼å‡ºåˆ°åŸæ–‡ä»¶å¤¹ã€‚
æä¾›å¯¼å‡ºæ–‡ä»¶å‘½åè§„åˆ™é€‰é¡¹ï¼š
    ä¿ç•™åŸæ–‡ä»¶åã€‚
    æ·»åŠ è‡ªå®šä¹‰å‰ç¼€ï¼ˆå¦‚ wm_ï¼‰ã€‚
    æ·»åŠ è‡ªå®šä¹‰åç¼€ï¼ˆå¦‚ _watermarkedï¼‰ã€‚
å¯¹äº JPEG æ ¼å¼ï¼Œæä¾›å›¾ç‰‡è´¨é‡ï¼ˆå‹ç¼©ç‡ï¼‰è°ƒèŠ‚æ»‘å—ï¼ˆ0-100ï¼‰ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
å¯¼å‡ºæ—¶å…è®¸ç”¨æˆ·è°ƒæ•´å›¾ç‰‡å°ºå¯¸ï¼ˆå¦‚æŒ‰å®½åº¦ã€é«˜åº¦æˆ–ç™¾åˆ†æ¯”ç¼©æ”¾ï¼‰ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
2. æ°´å°ç±»å‹
2.1æ–‡æœ¬æ°´å°
å†…å®¹ï¼šç”¨æˆ·å¯è‡ªå®šä¹‰è¾“å…¥ä»»æ„æ–‡æœ¬ã€‚
å­—ä½“ï¼šå¯é€‰æ‹©ç³»ç»Ÿå·²å®‰è£…çš„å­—ä½“ã€å­—å·ã€ç²—ä½“ã€æ–œä½“ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
é¢œè‰²ï¼šæä¾›è°ƒè‰²æ¿è®©ç”¨æˆ·é€‰æ‹©å­—ä½“é¢œè‰²ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
é€æ˜åº¦ï¼šå¯è°ƒèŠ‚æ–‡æœ¬çš„é€æ˜åº¦ï¼ˆ0-100%ï¼‰ã€‚
æ ·å¼ï¼šå¯æ·»åŠ é˜´å½±æˆ–æè¾¹æ•ˆæœï¼Œä»¥å¢å¼ºåœ¨å¤æ‚èƒŒæ™¯ä¸‹çš„å¯è¯»æ€§ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
2.2å›¾ç‰‡æ°´å°ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
ç”¨æˆ·å¯ä»æœ¬åœ°é€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼ˆå¦‚Logoï¼‰ä½œä¸ºæ°´å°ã€‚
å¿…é¡»æ”¯æŒå¸¦é€æ˜é€šé“çš„ PNG å›¾ç‰‡ã€‚
ç¼©æ”¾ï¼šå¯æŒ‰æ¯”ä¾‹æˆ–è‡ªç”±è°ƒæ•´å›¾ç‰‡æ°´å°çš„å¤§å°ã€‚
é€æ˜åº¦ï¼šå¯è°ƒèŠ‚å›¾ç‰‡æ°´å°çš„æ•´ä½“é€æ˜åº¦ï¼ˆ0-100%ï¼‰ã€‚
3. æ°´å°å¸ƒå±€ä¸æ ·å¼
3.1å®æ—¶é¢„è§ˆï¼šæ‰€æœ‰å¯¹æ°´å°çš„è°ƒæ•´éƒ½åº”åœ¨ä¸»é¢„è§ˆçª—å£ä¸­å®æ—¶æ˜¾ç¤ºæ•ˆæœã€‚ç”¨æˆ·å¯ä»¥ç‚¹å‡»å›¾ç‰‡åˆ—è¡¨åˆ‡æ¢é¢„è§ˆä¸åŒçš„å›¾ç‰‡ã€‚
3.2ä½ç½®
    é¢„è®¾ä½ç½®ï¼šæä¾›ä¹å®«æ ¼å¸ƒå±€ï¼ˆå››è§’ã€æ­£ä¸­å¿ƒï¼‰ï¼Œç”¨æˆ·å¯ä¸€é”®å°†æ°´å°æ”¾ç½®åœ¨è¿™äº›ä½ç½®ã€‚
    æ‰‹åŠ¨æ‹–æ‹½ï¼šç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨é¢„è§ˆå›¾ä¸Šé€šè¿‡é¼ æ ‡æ‹–æ‹½æ°´å°åˆ°ä»»æ„ä½ç½®ã€‚
3.3æ—‹è½¬ï¼šæä¾›ä¸€ä¸ªæ»‘å—æˆ–è¾“å…¥æ¡†ï¼Œå…è®¸ç”¨æˆ·ä»¥ä»»æ„è§’åº¦æ—‹è½¬æ°´å°ã€‚ï¼ˆå¯é€‰é«˜çº§åŠŸèƒ½ï¼‰
4. é…ç½®ç®¡ç†
4.1 æ°´å°æ¨¡æ¿ï¼š
ç”¨æˆ·å¯ä»¥å°†å½“å‰çš„æ°´å°è®¾ç½®ï¼ˆåŒ…æ‹¬æ°´å°å†…å®¹ã€å­—ä½“ã€é¢œè‰²ã€ä½ç½®ã€å¤§å°ã€é€æ˜åº¦ç­‰æ‰€æœ‰å‚æ•°ï¼‰ä¿å­˜ä¸ºä¸€ä¸ªæ¨¡æ¿ã€‚
ç”¨æˆ·å¯ä»¥åŠ è½½ã€ç®¡ç†å’Œåˆ é™¤å·²ä¿å­˜çš„æ¨¡æ¿ã€‚
ç¨‹åºå¯åŠ¨æ—¶å¯è‡ªåŠ¨åŠ è½½ä¸Šä¸€æ¬¡å…³é—­æ—¶çš„è®¾ç½®æˆ–ä¸€ä¸ªé»˜è®¤æ¨¡æ¿ã€‚
é«˜çº§åŠŸèƒ½è¯·å°½å¯èƒ½å®Œæˆï¼Œä¸ä½œä¸ºå¿…é¡»å†…å®¹ã€‚

#### æœ¬åœ° pyæ–‡ä»¶è¿è¡Œè¯´æ˜

```bash
streamlit run watermark_app.py
# æ‰“å¼€ï¼šhttp://localhost:8501
```

#### Windows Pyinstaller æ‰“åŒ…è¯´æ˜

> å‚è€ƒ: https://zhuanlan.zhihu.com/p/695939376

```bash
# å…è®¸æœ¬åœ°è„šæœ¬è¿è¡Œ
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
# æ¿€æ´» uv è™šæ‹Ÿç¯å¢ƒ(é¦–å…ˆ uv sync)
.venv\Scripts\activate
# ç”Ÿæˆ run.specæ–‡ä»¶
pyinstaller --onefile --additional-hooks-dir=./hooks run.py --clean
# ç”Ÿæˆ run.exeæ–‡ä»¶
pyinstaller run.spec --clean
```
